"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultOptions=exports.parsers=exports.options=exports.languages=void 0;const prettier_1=__importDefault(require("prettier")),parser_babel_1=require("prettier/parser-babel"),parser_typescript_1=require("prettier/parser-typescript"),parser_1=require("@babel/parser"),types_1=require("@babel/types"),generator_1=__importDefault(require("@babel/generator")),languages=prettier_1.default.getSupportInfo().languages.filter((({name:e})=>["JavaScript","JSX","TSX","TypeScript"].includes(e)));function traverse(e,{onVisit:t}){!function e(r){if(r&&"string"==typeof r.type){t(r);for(const t in r){const s=r[t];if(Array.isArray(s))for(let t=0;t<s.length;t++){e(s[t])}else e(s)}}}(e)}exports.languages=languages;const EMPTY_LINE_REGEX=/^\s*$/,DUMMY_COMMENT="/*DUMMY_COMMENT_BY_PRETTIER_PLUGIN_FORMAT*/";function replaceEmptyLinesWithDummyComment(e,t){const r=new Set;traverse(t.program,{onVisit(e){var t,s;if("TemplateLiteral"!==e.type)return;const o=null===(t=e.loc)||void 0===t?void 0:t.start.line;if("number"!=typeof o)return;const n=(null===(s=e.loc)||void 0===s?void 0:s.end.line)||o;for(let e=o;e<=n;e++)r.add(e)}});return e.split("\n").map(((e,t)=>{const s=!r.has(t+1);return EMPTY_LINE_REGEX.test(e)&&s?DUMMY_COMMENT:e})).join("\n")}function restoreEmptyLines(e){return e.split("\n").map((e=>e===DUMMY_COMMENT?"":e)).join("\n")}function getImportedStyleFnLocalName(e){let t="";for(const r of e.program.body)if("ImportDeclaration"===r.type&&"react-css-cx"===r.source.value)for(const e of r.specifiers)"ImportSpecifier"===e.type&&"Identifier"===e.imported.type&&"style"===e.imported.name&&(t=e.local.name||e.imported.name);return t||null}function getTemplateLiterals(e,t){var r;const s=[];for(const o of e.program.body)if("VariableDeclaration"===o.type)for(const e of o.declarations)"VariableDeclarator"===e.type&&"TaggedTemplateExpression"===(null===(r=e.init)||void 0===r?void 0:r.type)&&"Identifier"===e.init.tag.type&&e.init.tag.name===t&&s.push(e.init.quasi);return s}function modifyTemplateLiterals(e){const t=getImportedStyleFnLocalName(e);if(!t)return null;const r=getTemplateLiterals(e,t);for(const e of r)for(let t=0;t<e.quasis.length;t++){const r=e.quasis[t];if("TemplateElement"!==r.type)continue;if(r.value.raw!==r.value.cooked){console.log("Unhandled case for code modification");continue}const s=[];let o=!0;const n=r.value.raw.split("\n");for(let e=0;e<n.length;e++){const t=n[e],r=EMPTY_LINE_REGEX.test(t);if(0!==e&&e!==n.length-1||!r)if(r)s.push("");else for(const e of t.trim().replace(/\s+/g," ").split(" "))o=!1,s.push("  "+e)}if(o){r.value.raw=1===e.quasis.length?"":"\n";continue}const i=e.expressions.at(t);let a="";a+="\n",a+=s.join("\n"),a+="\n",i&&(a+="  "),r.value.raw=a}}function defaultPreprocessor(e,t){try{const r=t.parser,s={sourceType:"module",plugins:"typescript"===r?["jsx","typescript"]:["jsx"]};let o=(0,parser_1.parse)(e,s);e=replaceEmptyLinesWithDummyComment(e,o),o=(0,parser_1.parse)(e,s),modifyTemplateLiterals(o);const n=(0,types_1.file)({type:"Program",body:o.program.body,directives:o.program.directives,sourceType:"module",sourceFile:o.program.sourceFile,leadingComments:o.program.leadingComments,innerComments:o.program.innerComments,trailingComments:o.program.trailingComments,start:null,end:null,loc:null});return restoreEmptyLines((0,generator_1.default)(n).code)}catch(e){console.warn("PRETTIER PLUGIN FORMAT ERROR:",e)}}const parsers={babel:Object.assign(Object.assign({},parser_babel_1.parsers.babel),{preprocess:defaultPreprocessor}),typescript:Object.assign(Object.assign({},parser_typescript_1.parsers.typescript),{preprocess:defaultPreprocessor})};exports.parsers=parsers;const options={};exports.options=options;const defaultOptions={};exports.defaultOptions=defaultOptions;